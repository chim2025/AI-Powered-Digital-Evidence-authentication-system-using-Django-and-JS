{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EvideHub Dashboard</title>
  <link rel="stylesheet" href="/static/css/process.css" />

  <link rel="stylesheet" href="/static/css/dashboard.css" />
  <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">

  <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <link href="https://fonts.googleapis.com/css2?family=Orbitron&family=Roboto&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Add this in your <head> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

</head>
<body>
  <div class="sidebar">
    <h1 id="title-header">EvidenceHub</h1>
    <div class="nav-link active" data-section="home">
        <i class="fas fa-home"></i> Home
      </div>
      <div class="nav-link" data-section="task">
        <i class="fas fa-compass"></i> Task Wizard
      </div>
      <div class="nav-link" data-section="analytics">
        <i class="fas fa-chart-line"></i> Analytics
      </div>
      <!-- <div class="nav-link" data-section="recent-tasks">
        <i class="fas fa-clock"></i> Recent Tasks
      </div>
      <div class="nav-link" data-section="reports">
        <i class="fas fa-file-alt"></i> Reports
      </div> -->
      <div class="nav-link" data-section="system-info">
        <i class="fas fa-desktop"></i> System Info
      </div>
      <div class="nav-link" data-section="community">
        <i class="fas fa-users"></i> Community
      </div>
      <div class="nav-link" data-section="settings">
        <i class="fas fa-cog"></i> Settings
      </div>
      <div class="nav-link" data-section="support">
        <i class="fas fa-tools"></i> Support
      </div>
      <!-- ðŸ”¹ Added Logout -->
        <a href="{% url 'logout' %}" class="nav-link">
          <i class="fas fa-sign-out-alt"></i> Logout
        </a>
      
  </div>
   {% if messages %}
  <div class="custom-alert-container">
    {% for message in messages %}
      <div class="custom-alert {{ message.tags }}">
        <span class="close-btn" onclick="this.parentElement.style.display='none';">&times;</span>
        {{ message }}
      </div>
    {% endfor %}
  </div>
{% endif %}
<style>
  .custom-alert-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
    width: 300px;
  }

  .custom-alert {
    padding: 15px 20px;
    margin-bottom: 10px;
    border-radius: 8px;
    font-size: 14px;
    color: #fff;
    position: relative;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    animation: fadeIn 0.5s ease-in-out;
    opacity: 1;
    transition: opacity 0.5s ease-out;
  }

  .custom-alert.success {
    background-color: #28a745; /* green */
  }

  .custom-alert.error {
    background-color: #dc3545; /* red */
  }

  .custom-alert.info {
    background-color: #17a2b8; /* blue */
  }

  .close-btn {
    position: absolute;
    top: 5px;
    right: 10px;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
<script>
  
  setTimeout(() => {
    const alerts = document.querySelectorAll('.custom-alert');
    alerts.forEach(alert => {
      alert.style.opacity = '0';
      setTimeout(() => {
        alert.style.display = 'none';
      }, 500); 
    });
  }, 5000); 
</script>

  <div class="main-content">
    <div class="header">
        <div class="date" id="datetime"></div>
      
        <div class="system-info-inline">
          <div class="info-item">
            <i class="fas fa-desktop"></i>
            <span id="os-name">OS: <b>{{system_info.os_version}}</b></span>
          </div>
      
          <div class="info-item">
            <i class="fas fa-network-wired"></i>
            <span id="ip-address">Public IP: <b></b></span>
          </div>
          <div class="info-item">
            <i class="fas fa-globe"></i>
            <span id="browser-name">Browser: <b></b></span>
          </div>
        </div>
      
        <div class="avatar">
          <i class="fas fa-user-circle"></i>
        </div>
      </div>
    <div class="first_flex">
      
    <div class="first_info">
    <div class="welcome">Welcome, {{user.last_name}} {{user.first_name}}!</div>
    <div class="description">Gain insights into your digital evidence.</div>
    
    </div>
    <div class="process_details">
      <div class="current_processes"></div>
      <div class="malicious_process"></div>
      <div class="virus_total_flagged"></div>
      <div class="yara_rules_malicious open_threats_num"></div>
      <div class="run_full_scan">
        <button id="button">Scan now</button>
      </div>

    </div>
    </div>

    <div class="stats">
      <div class="card">
        <h2>System Memory</h2>
        <div class="value">46%</div>
      </div>
      <div class="card">
        <h2>Total Evidence Reviewed</h2>
        <div class="value">5</div>
      </div>
      <div class="card">
        <h2>Passed</h2>
        <div class="value">0%</div>
      </div>
      <div class="card">
        <h2>Active Tasks</h2>
        <div class="value">0</div>
      </div>
    </div>

    <div class="recent-tasks">
      <h2>Recent Tasks</h2>
      <table>
        <thead>
          <tr>
            <th>Task</th>
            <th>Type</th>
            <th>Date</th>
            <th>Result</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Image Forgery Detection</td>
            <td>Image</td>
            <td>Apr 23, 2024</td>
            <td><span class="status-failed">Failed</span></td>
            <td><button class="view-btn">View</button></td>
          </tr>
          <tr>
            <td>Deepfake Analysis</td>
            <td>Video</td>
            <td>Apr 22, 2024</td>
            <td>Apr 22, 2024</td>
            <td><button class="view-btn">View</button></td>
          </tr>
          <tr>
            <td>Document Authenticity</td>
            <td>PDF</td>
            <td>Apr 22, 2024</td>
            <td>Apr 22</td>
            <td><button class="view-btn">View</button></td>
          </tr>
          <tr>
            <td>Audio Tampering</td>
            <td>Audio</td>
            <td>Apr 21, 2024</td>
            <td>Passed</td>
            <td><button class="view-btn">View</button></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div id="running_process" class="hidden">
      <div id="loadingOverlay" class="loading-overlay hidden" role="status" aria-live="assertive" aria-busy="true">
  <div class="modal-spinner-container">
    <div class="modal-spinner-ring"></div>
    <div class="modal-spinner-core"></div>
    <div class="modal-spinner-glow"></div>
  </div>
  <span>Getting Computer Processes Ready for Presentation<br><small>It can take up to two minutes</small>
  </span>
  
  
  <div class="modern-quote-box"></div>
</div>
      

    </div>


  </div>
  
  <section id="settings" class="content-section">
    <h2>Settings</h2>
    <p>Configure your system preferences below.</p>
  
    <div class="setting-option">
      <h3> Theme Selection</h3>
        <p>Select your preferred theme:</p>
      
      <div class="theme-toggle">
        <label class="toggle-switch">
          <input type="radio" id="theme-light" name="theme" value="light" checked>
          <span>Light</span>
        </label>
        <label class="toggle-switch">
          <input type="radio" id="theme-dark" name="theme" value="dark">
          <span>Dark</span>
        </label>
      </div>
    </div>
  
    <div class="setting-option">
      <h3> Notification Preferences</h3>
        <p>Choose your notification preferences:</p>
      <label class="checkbox-wrap">
        <input type="checkbox" id="email-notifications" checked>
        <span>Enable Inbuilt software alerts</span>
      </label>
      <label class="checkbox-wrap">
        <input type="checkbox" id="system-notifications" checked>
        <span>Enable System Notifications</span>
      </label>
      <label class="toggle-switch">
        <input type="checkbox" id="email-notifications" checked>
        <span class="switch-slider"></span>
        <span>Send me Email notifications</span>
      </label>
    </div>
  
    <div class="setting-option">
      <h3>Account Settings</h3>
      <label class="checkbox-wrap">
        <input type="checkbox" id="email-notifications" checked>
        <span>Apply Profile Change Feature</span>
      </label>
      <label class="checkbox-wrap">
        <input type="checkbox" id="system-notifications" checked>
        <span>Enable Automatic Database Storage</span>
      </label>
      <button id="change-password" onclick="alert('Redirect to change password page')">
        Change Password
      </button>
    </div>
  
    <div class="setting-option">
      <h3>Language Selection</h3>
      <select id="language">
        <option value="en">English</option>
        <option value="es">EspaÃ±ol</option>
        <option value="fr">FranÃ§ais</option>
        <option value="de">Deutsch</option>
      </select>
    </div>
  
    <div class="setting-option">
      <h3> Privacy Settings</h3>
      <label class="checkbox-wrap">
        <input type="checkbox" id="data-tracking" checked>
        <span>Allow Data Tracking</span>
      </label>
    </div>
  </section>

  <section id="task" class="content-section">
    <!--  <button class="task-button task-wizard-trigger"><i class="fas fa-compass"></i>Launch Task Wizard</button>-->
      <div class="task-display-text">
        <h3> Let's Start Automated Scans for You</h3>
      </div>
      <div class="task-display-button">
    <button class="task-button task-wizard-trigger"><span class="fas fa-plus"></span> New Task</button>
    <button><span class="fas fa-code-compare"></span> Comparator </button>
    <button><span class="fas fa-tools"></span> Other Task</button>
  </div>

    <div id="taskWizardModal" class="modal">
      <div class="modal-content">
        <div class="progress-bar">
          <div class="progress"></div>
        </div>
    
        <span class="close-bt">&times;</span>
    
        <!-- Step 1 -->
        <div id="wizard-step-1" class="wizard-step active">
          <h2 id="info">Task Information</h2>
        
          <div class="form-group">
            <label for="taskName" id="nameLabel">
              <i class="fas fa-tasks"></i> Evidence Name
            </label>
            <input type="text" placeholder="Input the name of your task here..." id="taskName">
          </div>
        
          <div class="form-group">
            <label for="taskDescription">
              <i class="fas fa-align-left"></i> Evidence Description
            </label>
            <textarea placeholder="The description of your task here..." id="taskDescription"></textarea>
          </div>
        
          <div class="form-group">
            <label for="evidenceDate">
              <i class="fas fa-calendar-alt"></i> Evidence Date
            </label>
            <input type="text" id="evidenceDate" readonly>
          </div>
        
          <div class="wizard-navigation">
            <button id="nextStep">Next  <span class="fas fa-arrow-right"></span></button>
          </div>
        </div>
        
    
        <!-- Step 2 -->
        <div id="wizard-step-2" class="wizard-step">
          <h2>Evidence Upload</h2>
          <div class="upload-box" id="uploadArea">
            <i class="fas fa-cloud-upload-alt upload-icon"></i>
            <p id="uploadText">Click or Drag Files to Upload</p>
            <input type="file" id="evidenceFiles" multiple hidden>
          </div>
    
          <div id="evidencePreview" class="preview-container"></div>
    
          <div class="wizard-navigation">
            <button id="prevStep"><span class="fas fa-arrow-left"></span>  Previous</button>
            
            <button id="startAnalysisBtn" class="start-analysis-btn"> Start Analysis  <span class="fas fa-play"></span></button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="analytics" class="content-section">
  

    
    <div id="analytics_section" class="section">

    <div class="no-process">
        <i class="fas fa-clock"></i>
        <p>No analysis currently running.</p>
    </div>
</div>
<div id="heatmapModal" class="modal">
  <span class="close" onclick="closeHeatmapModal()">&times;</span>
  <img id="heatmapModalImg" class="modal-content">
  <div class="modal-caption">Enlarged Evidence Image</div>
</div>

  </section>

<section id="system-info" class="content-section system-info-section">
  <h2 class="fw"><i class="fas fa-desktop"></i> System Information</h2>
  <div class="system-info-grid">
    <div class="info-tile">
  <i class="fas fa-microchip"></i>
  <div>
    <h4>CPU Model</h4>
    <p>{{ system_info.cpu_model }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-memory"></i>
  <div>
    <h4>RAM</h4>
    <p>{{ system_info.ram }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-hdd"></i>
  <div>
    <h4>Disk Space</h4>
    <p>{{ system_info.disk }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-network-wired"></i>
  <div>
    <h4>IP Address</h4>
    <p>{{ system_info.ip_address }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-microchip"></i>
  <div>
    <h4>CPU Cores</h4>
    <p>{{ system_info.cores }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-ethernet"></i>
  <div>
    <h4>MAC Address</h4>
    <p>{{ system_info.mac_address }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-desktop"></i>
  <div>
    <h4>System Uptime</h4>
    <p>{{ system_info.uptime }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-calendar-day"></i>
  <div>
    <h4>Boot Time</h4>
    <p>{{ system_info.boot_time }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-microchip"></i>
  <div>
    <h4>CPU Usage</h4>
    <p>{{ system_info.cpu_usage }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-tasks"></i>
  <div>
    <h4>Running Processes</h4>
    <p>{{ system_info.processes }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-laptop"></i>
  <div>
    <h4>Hostname</h4>
    <p>{{ system_info.hostname }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-code-branch"></i>
  <div>
    <h4>OS Version</h4>
    <p>{{ system_info.os_version }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-clock"></i>
  <div>
    <h4>System Time</h4>
    <p>{{ system_info.system_time }}</p>
  </div>
</div>

<div class="info-tile">
  <i class="fas fa-calendar-check"></i>
  <div>
    <h4>System Date</h4>
    <p>{{ system_info.system_date }}</p>
  </div>
</div>

   <!--- system-info details ... -->
  </div>
</section>


  
<script src="/static/js/hexy.js" onerror="this.onerror=null; this.src='https://unpkg.com/hexy@0.3.3/lib/hexy.js';"></script>

  <script type="module" src="/static/js/dashboard.js"></script>
  <script type="module" src="/static/js/evidenceupload.js"></script>
  <script type="module" src="/static/js/renderevidence.js"></script>
  <script type="module" src="/static/js/process.js"></script>
  <script type="module" src="/static/js/process_metrics.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


  <script>
    document.addEventListener('DOMContentLoaded', () => {
      
      const savedTheme = localStorage.getItem('theme');
      const savedLanguage = localStorage.getItem('language');
      const savedEmailNotif = localStorage.getItem('emailNotifications') === 'true';
      const savedSystemNotif = localStorage.getItem('systemNotifications') === 'true';
      const savedTracking = localStorage.getItem('dataTracking') === 'true';
    
      if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
        document.getElementById(`theme-${savedTheme}`).checked = true;
      }
    
      if (savedLanguage) {
        document.getElementById('language').value = savedLanguage;
      }
    
      document.getElementById('email-notifications').checked = savedEmailNotif;
      document.getElementById('system-notifications').checked = savedSystemNotif;
      document.getElementById('data-tracking').checked = savedTracking;
    
   
      document.querySelectorAll('input[name="theme"]').forEach(radio => {
        radio.addEventListener('change', () => {
          const theme = radio.value;
          document.documentElement.setAttribute('data-theme', theme);
          localStorage.setItem('theme', theme);
        });
      });
    
     
      document.getElementById('language').addEventListener('change', (e) => {
        localStorage.setItem('language', e.target.value);
      });
    
      
      const saveToggle = (id, key) => {
        document.getElementById(id).addEventListener('change', (e) => {
          localStorage.setItem(key, e.target.checked);
        });
      };
    
      saveToggle('email-notifications', 'emailNotifications');
      saveToggle('system-notifications', 'systemNotifications');
      saveToggle('data-tracking', 'dataTracking');
    });
    </script>
    <div id="toast"></div>
    
</body>
</html>